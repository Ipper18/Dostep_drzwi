<h1>Permissions List</h1>

<% @cards = Card.includes(permissions: :rooms).order(:id) %>
<% @cards.each do |card| %>
  <h2>Karta numer: <%= card.id %></h2>
  <table>
    <thead>
      <tr>
        <th>Card ID</th>
        <th>Rooms</th>
        <th>Valid from</th>
        <th>Valid to</th>
        <th colspan="3"></th>
      </tr>
    </thead>
    <tbody>
      <% card.permissions.each do |permission| %>
        <tr>
          <td><%= card.id %></td>
          <td>
            <% permission.rooms.each do |room| %>
              <%= room.room_name %><br>
            <% end %>
          </td>
          <td><%= permission.valid_from %></td>
          <td><%= permission.valid_to %></td>
          <td><%= link_to 'Show', permission %></td>
          <td><%= link_to 'Edit', edit_permission_path(permission) %></td>
          <td><%= link_to 'Destroy', permission, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>

<%= link_to 'New Permission', new_permission_path %>

<div>
  <%= link_to 'PowrÃ³t do Panelu Sterowania', dashboard_path, class: 'btn btn-primary' %>
</div>
